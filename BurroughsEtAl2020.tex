%%%%%%%%%%%%%%%%%%%%%%% file template.tex %%%%%%%%%%%%%%%%%%%%%%%%%
%
% This is a general template file for the LaTeX package SVJour3
% for Springer journals.          Springer Heidelberg 2010/09/16
%
% Copy it to a new file with a new name and use it as the basis
% for your article. Delete % signs as needed.
%
% This template includes a few options for different layouts and
% content for various journals. Please consult a previous issue of
% your journal as needed.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%\documentclass{svjour3}                     % onecolumn (standard format)
%\documentclass[smallcondensed]{svjour3}     % onecolumn (ditto)
%\documentclass[smallextended]{svjour3}       % onecolumn (second format)
\documentclass[twocolumn]{svjour3}          % twocolumn
%
\smartqed  % flush right qed marks, e.g. at end of proof
%
\usepackage{graphicx}
%
% \usepackage{mathptmx}      % use Times fonts if available on your TeX system
%
% insert here the call for the packages your document requires
%\usepackage{latexsym}
% etc.
%
% please place your own definitions here and don't use \def but
% \newcommand{}{}
%
% Insert the name of "your journal" with
% \journalname{myjournal}
%

\usepackage{amsmath}
\usepackage{natbib}
\bibliographystyle{abbrvnat}
\setcitestyle{authoryear,open={(},close={)}}

%% tikz stuff
\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{positioning}
\usepackage{gnuplot-lua-tikz}
\pgfarrowsdeclare{ha}{ha} 
{ 
  \arrowsize=2pt 
  \advance\arrowsize by .5\pgflinewidth 
  \pgfarrowsleftextend{-4\arrowsize-.5\pgflinewidth} 
  \pgfarrowsrightextend{.5\pgflinewidth} 
} 
{ 
  \arrowsize=0.2pt 
  \advance\arrowsize by .5\pgflinewidth 
  \pgfsetdash{}{0pt} % do not dash 
  \pgfsetroundjoin   % fix join 
  \pgfsetroundcap    % fix cap 
  \pgfpathmoveto{\pgfpoint{-8\arrowsize}{8\arrowsize}}
    \pgfpathlineto{\pgfpoint{0}{0}}
  \pgfusepathqstroke
} 


%% some abbreviations

% I changed msi to mS/cm2 as I thought it made it more obvious that it is per cm2 and we don't have a specific surface area in here.

%%% some SI units
\newcommand{\mv}{\,\mathrm{mV}}
%\newcommand{\msi}{\,\mathrm{mS \slash cm^{2}}}
\newcommand{\msi}{\,\mathrm{mS\,cm^{-2}}}
\newcommand{\mse}{\,\mathrm{ms}}
\newcommand{\msp}{\,\mathrm{ms^{-1}}}
\newcommand{\khz}{\,\mathrm{kHz}}
\newcommand{\hz}{\,\mathrm{Hz}}
\newcommand{\cm}{\,\mathrm{cm}}
\newcommand{\ums}{\,\mathrm{\mu m^2}}
%%% some ions

\renewcommand{\k}{\mathrm{K}}
\newcommand{\ca}{\mathrm{Ca}}
\newcommand{\tna}{\mathrm{FIX THIS}}
\newcommand{\rna}{\mathrm{FIX THIS}}
\newcommand{\na}{\mathrm{Na}}
\newcommand{\sk}{\mathrm{SK}}
\newcommand{\leak}{\mathrm{l}}


\begin{document}

\title{A Purkinje cell model that simulates complex spikes\thanks{ACB
    is funded by the Wellcome Trust Doctoral Training Programme in
    Neural Dynamics (099699/Z/12/Z), NLC and RA are funded by the
    Medical Research Council, UK (G1100626), CJH is funded by the
    James S. McDonnell Foundation (JSMF \#220020239) through a Scholar
    Award in Cognition. Some of this work was carried out using the
    computational facilities of the Advanced Computing Research
    Centre, University of Bristol - http://www.bris.ac.uk/acrc/}}

\author{Amelia Burroughs \and Nadia L. Cerminara \and Richard Apps \and Conor Houghton}

\institute{ A. Burroughs \at Department of Computer Science, University of Bristol, UK
  \and
  N.L. Cerminara \at School of Physiology, Pharmocology and Neuroscience, University of Bristol, UK
  \and
  R. Apps \at School of Physiology, Pharmocology and Neuroscience, University of Bristol, UK
  \and
  C. Houghton \at Department of Computer Science, University of Bristol, UK\\ \email{conor.houghton@bristol.ac.uk}
}

\date{Received: data / Accepted: date}

\maketitle


\begin{abstract}

Purkinje cells are the principal neurons of the cerebellar cortex. One
of their distinguishing features is that they fire two distinct types
of action potential, called simple and complex spikes, which interact
with one another. Simple spikes are stereotypical action potentials
that are elicited at high, but variable, rates ($0-100\hz$) and have a
consistent waveform. Complex spikes are composed of an initial action
potential followed by a burst of lower amplitude spikelets. Complex
spikes occur at comparatively low rates ($\sim 1\hz$) and have a
variable waveform. Although they are critical to cerebellar operation
a simple model that describes the complex spike waveform is
lacking. Here, a novel single-compartment model of Purkinje cell
electrodynamics is presented. The simpler version of this model, with
two active conductances and a leak channel, can simulate the features
typical of complex spikes recorded \textit{in vitro}. If calcium
dynamics are also included, the model can also simulate the pause in
simple spike activity that occurs after complex spikes. Together,
these models provide an insight into the mechanisms behind complex
spike spikelet generation, waveform variability and their interactions
with simple spike activity.  \keywords{Purkinje cell, cerebellum,
  mathematical model, simulation, complex spike} \PACS{}

\end{abstract}

\section{Introduction}

Purkinje cells fire two distinct types of action potential, called
complex spikes and simple spikes, in response to two different types
of excitatory input relayed via climbing fibre and mossy fibre
afferents, respectively
\citep{PalayChanPalay1974,ito1984cerebellum,eccles2013cerebellum}. The
mossy fibres connect indirectly to the Purkinje cells via granule
cells; these, in turn signal to the Purkinje cells along the parallel
fibres. Activity within the mossy fibre - granule cell - parallel
fibre pathway modulates the already intrinsic simple spike activity of
Purkinje cells, which averages at $\sim 40\hz$ for spontaneous
activity in rats \citep{ArmstrongRawson1979}, cats
\citep{thach1967somatosensory} and monkeys \citep{fu1997relationship}
but can range from $0-200\hz$ \citep{chen2016cerebellum}. In marked
contrast, complex spikes are generated at only $\sim 1\hz$
\citep{lang1999patterns} in response to activity within the direct
climbing fibre pathway and are characterised by a prolonged,
multi-peaked action potential \citep{CampbellHesslow1986}. The initial
spike in a complex spike has a larger amplitude to the subsequent
peaks, these smaller peaks are known as spikelets, which are elicited
at $\sim 600\hz$ \citep{WarnaarEtAl2015,BurroughsEtAl2016}. The
complex spike is followed by an extended refractory period
\citep{VoogdGlickstein1998,EcclesLlinasSasaki1966,Fujita1968}.

Complex spikes, and their interactions with simple spikes, are central
to theories of cerebellar function
\citep{CampbellHesslow1986,eccles2013cerebellum,ito1984cerebellum,ito2011cerebellum,YangLispberger2014}.
While most theories consider complex spikes as unitary events, there
is increasing evidence to suggest that changes in the complex spike
waveform plays an important role. For example, there is recent
evidence that behaviourally salient information is transmitted by
variations in complex spike waveform and the duration of complex
spikes differs between spontaneous and sensory-evoked events
\citep{MarutaEtAl2007,NajafiMedina2013}. Complex spike duration also
appears to affect plasticity: the magnitude of motor learning and
synaptic plasticity in awake monkeys correlates with complex spike
duration \citep{YangLispberger2014}. It has also been proposed in
\citet{Houghton2014} that the refractory period which follows a
complex spike has a role in plasticity at the granule cell - Purkinje
cell synapse.

There is also emerging evidence for an interaction between complex
spike waveform changes, simple spike activity and behaviour
\citep{YangLispberger2014,StrengEtAl2017}. The best known interaction
is the pause in simple spike activity that follows a complex spike, but
an increasing number of studies indicate a relationship between simple
spike firing dynamics and complex spike activity
\citep{Mano1970,Gilbert1976,CampbellHesslow1986,HashimotoKano1998,ServaisEtAl2004,MarutaEtAl2007,WarnaarEtAl2015,BurroughsEtAl2016}.
Variations in complex spike waveform may dynamically regulate the
simple spike response of Purkinje cells in advance of changes in
behaviour in order to determine the motor outcome
\citep{StrengEtAl2017}. Furthermore, changes in the waveform of the
complex spike may serve a homeostatic role in maintaining Purkinje
cell simple spike activity within a useful operational range
\citep{BurroughsEtAl2016}.

Purkinje cell responses are highly variable: there is considerable
variation in firing rates, input response properties, morphology and
complex spike waveform. There are, however, some features that appear
to be generic to Purkinje cells: the spikelets that make up the
complex spike have a significantly smaller amplitude than the initial
spikes and there is an extended refractory period after a complex
spike. The purpose of this paper is to suggest mechanisms to support
these features by describing simple models that can simulate them.

Given the evidence that a dynamic interplay between complex spike
waveform and simple spike activity underlies cerebellar operation,
there is a need to gain a mechanistic understanding of the generation
of the complex spike and its interaction with simple spiking. Despite
the existence of a range of computational models to address various
features of Purkinje cells, a simple model that captures complex spike
generation, waveform variability and interactions with simple spike
activity is lacking. In the current paper we explore through
simulation the hypothesis that a restricted number of channel-dynamics
can explain complex spike waveform. Two models are presented: a
three-current model that shows that three channels, a leak channel and
two active channels, are sufficient to simulate the complex spike
waveform and a five-current model which demonstrates how some of the
interactions between simple spikes and complex spikes can be explained
by calcium dynamics.

These models serve as a description of ion-channel dynamics sufficient
to support complex spike production and should enable further analysis
of complex spiking and its relationship to simple spiking. In this
way, the models complement the large and detailed models described by
\citet{VeysEtAl2013,ZangEtAl2018} and give a starting point for a
model which also incorporates the interaction between simple spike
rate and complex spike waveform described in
\citet{BurroughsEtAl2016}.

\section{Methods}

%so the thing we completely fail to do is explain here why we pick those particular channels; we say more later but 
%it would be good to say something here as well

%perhaps do a general paragraph and note that the many choices made here will be reflected on in the discussion

In this paper two single-compartment models of the Purkinje cell
somatic voltage dynamics are presented. The three-current model has a
leak channel and two voltage-gated channels:
\begin{equation}
\label{eq:membrane_voltage_3}
C\frac{dV}{dt} =I_\leak+I_{\na}+I_\k+I_{\mathrm{e}}
\end{equation}
where $C = 1\,\mu\mathrm{F}\,\mathrm{\slash cm}^{2}$ is the membrane capacitance,
$I_{\leak}$ is a leak current,
\begin{equation}
\label{eq:I_L}
I_{\leak} =\bar{g}_{\leak}(E_\leak-V)
\end{equation}
with $\bar{g}_{\leak} = 2\msi$ and
$E_{\leak}=-88\mv$. $I_{\mathrm{e}}$ stands for the external input
current. This is described below and is made up of a background
current and a synaptic current entering the soma from the
dendrites. $I_{\na}$ and $I_{\k}$ stand for the sodium current and the
potassium current; the sodium current includes the resurgent dynamics
that are typical of Purkinje cells
\citep{RamanBean1997,RamanBean2001,KhaliqEtAl2003,KhaliqRaman2006}. Since
complex spikes are principally sodium spikes
\citep{StuartHausser1994}, this model contains the least possible
number of currents; the key contribution of this model is to
demonstrate that the sodium resurgence found in Purkinje cells is
sufficient as a mechanism for producing the complex spike waveform.

The second model includes some of the effects of calcium dynamics and
will be referred to as the five-current model. It has
\begin{equation}
\label{eq:membrane_voltage_5}
C\frac{dV}{dt} =I_{\leak}+I_{\na}+I_\k+I_\ca+I_\sk+I_{\mathrm{e}}
\end{equation}
In addition to the three-current model described above in
Eq~\ref{eq:membrane_voltage_3}, the five-current model also has a
calcium channel, with current $I_\ca$ and a calcium-gated potassium
channel, with current $I_\sk$. These two additional currents are also
described below; they were selected because they are a prominent
channel type in Purkinje cells and the calcium dynamics has timescales
in the range required to produce the refractory period after a complex
spike. Purkinje cell channels that are not included in either model
are described in the Discussion.

\subsection{Input currents}

In the Purkinje cell dendrites, climbing fibre activation evokes a
sustained depolarising calcium transient
\citep{KitamuraHaeusser2011}. This transient can include spikes and the
number of action potentials in the presynaptic climbing fibre burst can influence
the number of these dendritic calcium spikes
\citep{LlinasSugimori1980a,KitamuraHaeusser2011,DavieEtAl2008,MathyEtAl2009}. However
these calcium spikes are not well propagated from the dendrites into
the soma \citep{DavieEtAl2008} and as such the Purkinje cell soma most
likely receives the dendritic climbing fibre signal as a
depolarisation plateau carried mostly by calcium and non-inactivating, passive sodium
channels
\citep{LlinasSugimori1980b,KnopfelEtAl1990,LlinasNicholson1971,StuartHausser1994}. This
depolarisation plateau drives somatic complex spike formation, which
is initiated in the proximal axon \citep{StuartHausser1994,DavieEtAl2008,PalmerEtAl2010}. 

The current that the Purkinje cell soma receives following climbing
fibre activation from the dendrite is modelled as the difference of
two decaying exponentials and fitted to mimic the synaptic input given
in \citet{DavieEtAl2008}. For a complex spike at $t=0$ this is:
\begin{equation}
\label{eq:I_synapse}
I_{\mathrm{e}} = I_0+I_{\mathrm{cf}}\frac{e^{-t/\tau_-}-e^{-t/\tau_+}}{e^{-t_0/\tau_-}-e^{-t_0/\tau_+}}
\end{equation}
where $t_0$ is the time the double exponential function reaches its maximum:
\begin{equation}
t_0 = \frac{\tau_+\tau_-} {\tau_--\tau_+}\log{\frac{\tau_-}{\tau_+}}.
\end{equation}
$I_0$ is a background current and $I_{\mathrm{cf}}$ is the maximum
amplitude. $\tau_+=0.3\mse$ and $\tau_-=4\mse$ are the rise and decay
timescales respectively.

\subsection{Ion channels}

\begin{table*}[!t]
\begin{center}
\begin{tikzpicture}
\node    (C1)                     {C$_1$};
\node    (C12)[right of=C1] {};
\node    (C12u)[above = -0.1cm of C12]{$4\alpha$};
\node    (C12b)[below = -0.1cm of C12]{$\beta$};
\node    (C2)[right of=C12]   {C$_2$};
\node    (C23)[right of=C2] {};
\node    (C23u)[above = -0.1cm of C23]{$3\alpha$};
\node    (C23b)[below = -0.1cm of C23]{$2\beta$};
\node    (C3)[right of=C23]   {C$_3$};
\node    (C34)[right of=C3] {};
\node    (C34u)[above = -0.1cm of C34]{$2\alpha$};
\node    (C34b)[below = -0.1cm of C34]{$3\beta$};
\node    (C4)[right of=C34]   {C$_4$};
\node    (C45)[right of=C4] {};
\node    (C45u)[above = -0.1cm of C45]{$\alpha$};
\node    (C45b)[below = -0.1cm of C45]{$4\beta$};
\node    (C5)[right of=C45]   {C$_5$};
\node    (C5O)[right of=C5] {};
\node    (C5Ou)[above = -0.1cm of C5O]{$\gamma$};
\node    (C5Ob)[below = -0.1cm of C5O]{$\delta$};
\node    (O)[right of =C5O]   {O};
\node    (OB)[right of=O] {};
\node    (OBu)[above = -0.1cm of OB]{$\epsilon$};
\node    (OBb)[below = -0.1cm of OB]{$\xi$};
\node    (B)[right of =OB]   {B};

\node    (C1I1)[below of=C1] {};
\node    (C1I1l)[left = -0.1cm of C1I1]{\scriptsize{$U$}};
\node    (C1I1r)[right = -0.1cm of C1I1]{\scriptsize{$D$}};
\node    (C2I2)[below of=C2] {};
\node    (C2I2l)[left = -0.1cm of C2I2]{$\frac{U}{a}$};
\node    (C2I2r)[right = -0.1cm of C2I2]{\scriptsize{$Da$}};
\node    (C3I3)[below of=C3] {};
\node    (C3I3l)[left = -0.1cm of C3I3]{$\frac{U}{a^2}$};
\node    (C3I3r)[right = -0.1cm of C3I3]{\scriptsize{$Da^2$}};
\node    (C4I4)[below of=C4] {};
\node    (C4I4l)[left = -0.1cm of C4I4]{$\frac{U}{a^3}$};
\node    (C4I4r)[right = -0.1cm of C4I4]{\scriptsize{$Da^3$}};
\node    (C5I5)[below of=C5] {};
\node    (C5I5l)[left = -0.1cm of C5I5]{$\frac{U}{a^4}$};
\node    (C5I5r)[right = -0.1cm of C5I5]{\scriptsize{$Da^4$}};
\node    (OI6)[below of=O] {};
\node    (OI6l)[left = -0.1cm of OI6]{\scriptsize{$F$}};
\node    (OI6r)[right = -0.1cm of OI6]{\scriptsize{$N$}};

\node    (I1)[below of=C1I1]   {I$_1$};
\node    (I12)[right of=I1] {};
\node    (I12u)[above = -0.1cm of I12]{$\alpha a$};
\node    (I12b)[below = -0.1cm of I12]{$4\beta/a$};
\node    (I2)[right of=I12]   {I$_2$};
\node    (I23)[right of=I2] {};
\node    (I23u)[above = -0.1cm of I23]{$2\alpha a$};
\node    (I23b)[below = -0.1cm of I23]{$3\beta/a$};
\node    (I3)[right of=I23]   {I$_3$};
\node    (I34)[right of=I3] {};
\node    (I34u)[above = -0.1cm of I34]{$3\alpha a$};
\node    (I34b)[below = -0.1cm of I34]{$2\beta/a$};
\node    (I4)[right of=I34]  {I$_4$};
\node    (I45)[right of=I4] {};
\node    (I45u)[above = -0.1cm of I45]{$4\alpha a$};
\node    (I45b)[below = -0.1cm of I45]{$\beta/a$};
\node    (I5)[right of=I45]  {I$_5$};
\node    (I56)[right of=I5] {};
\node    (I56u)[above = -0.1cm of I56]{$\gamma$};
\node    (I56b)[below = -0.1cm of I56]{$\delta$};
\node    (I6)[right of=I56]  {I$_6$};
\draw[ha-ha] (C1) -- (C2);
\draw[ha-ha] (C2) -- (C3);
\draw[ha-ha] (C3) -- (C4);
\draw[ha-ha] (C4) -- (C5);
\draw[ha-ha] (C5) -- (O);
\draw[ha-ha] (O) -- (B);
\draw[ha-ha] (I1) -- (I2);
\draw[ha-ha] (I2) -- (I3);
\draw[ha-ha] (I3) -- (I4);
\draw[ha-ha] (I4) -- (I5);
\draw[ha-ha] (I5) -- (I6);
\draw[ha-ha] (I1) -- (C1);
\draw[ha-ha] (I2) -- (C2);
\draw[ha-ha] (I3) -- (C3);
\draw[ha-ha] (I4) -- (C4);
\draw[ha-ha] (I5) -- (C5);
\draw[ha-ha] (I6) -- (O);
\end{tikzpicture}
\end{center}
where
\begin{eqnarray*}
\alpha &=& 150\exp{\left(\frac{V}{20\mv}\right)}\msp\cr
\beta  &=& 3\exp{\left(-\frac{V}{20\mv}\right)}\msp\cr
\xi    &=& 0.03\exp{\left(-\frac{V}{25\mv}\right)}\msp
\end{eqnarray*}
and $\gamma = 150\msp$, $\delta= 40\msp$, $\epsilon = 1.75\msp$, $D=0.005\msp$, $U= 0.5\msp$, $N=0.75\msp$, $F=0.005\msp$ with
$$
a=[(U/D)/(F/N)]^{1/8}=3.3267
$$
\caption{\textbf{Current through the resurgent sodium channel is
    described using a Markovian Scheme.} $C_1$-$C_5$ describe
  sequential closed configurations; $I_1$-$I_6$ describe sequential
  inactivated states; $O$ represents the open channel configuration,
  sodium ions will only pass through the channel when it is in this
  state. $B$ describes a second inactivated state where the channel is
  likened to being in an open-but-blocked configuration that is
  non-conducting. Return from this state back to the closed, or
  inactivated, states must occur through the open ($O$)
  configuration. The rate constants describing transitions between
  states; all rate values have been taken from
  \protect\citet{RamanBean2001}.
\label{fig:MarkovRNa}}
\end{table*}

The current through the sodium channel was modelled using a Markovian
scheme developed by \citet{RamanBean2001}, see
Table~\ref{fig:MarkovRNa}. This scheme models the dynamics of both the
transient and resurgent gates. The current is
\begin{equation}
\label{eq:I_RNa}
I_{\na} = \bar{g}_\na o (E_\na-V)
\end{equation}
$o$ is the fraction of gates in the open state $O$, as described in Table~\ref{fig:MarkovRNa}.

The potassium current has a fast potassium channel of the K\textsubscript{v}3.3 subtype and is modelled as in
\citet{MasoliEtAl2015}:
\begin{equation}
\label{eq:I_K}
I_{\k} = \bar{g}_{\k} n^4(E_{\k}-V)
\end{equation}
Channel kinetics are described with the usual Hodgkin-Huxley channel equation but with:
\begin{align}
\label{eq:n_kinetics}
\alpha_{n} &= 0.22
\exp{\left(\frac{V-30\mv}{26.5\mv}\right)}\mathrm{ms}^{-1}\cr 
\beta_{n} &= 0.22
\exp{\left(-\frac{V-30\mv}{26.5\mv}\right)}\mathrm{ms}^{-1}
\end{align}

The five-current model extends the three-current model to include
calcium. It adds a calcium channel, a model of calcium concentration
dynamics in the soma and a calcium-gated potassium channel. The
calcium channel is a P/Q type calcium channel with equations and
parameter values the same as those in \citet{MiyashoEtAl2001}. The
current is described by
\begin{equation}
\label{eq:I_Ca}
I_\ca =\bar{g}_{\ca} q(E_\ca-V)
\end{equation}
where $q$ is the proportion of gates in the open state. Channel kinetics are given by
\begin{align}
\label{eq:q_kinetics}
\alpha_{q} &= \frac{8.5}{ 1 +
  \exp{\left(-\frac{V}{12.5\mv}\right)}}\mathrm{ms}^{-1}\cr \beta_{q} &=
\frac{35}{ 1 + \exp{\left(\frac{V}{14.5\mv}\right)}}\mathrm{ms}^{-1}
\end{align}

The intracellular calcium concentration dynamics are taken from
\citet{SterrattEtAl2012,KochSegev1998}
\begin{equation}
\label{eq:ca_concentration}
\frac{d[\ca^{2+}]}{dt}=\gamma (I_\ca+cI_{\mathrm{e}})  -
\rho ([\ca^{2+}]-[\ca^{2+}]_0)
\end{equation}
Thus, calcium enters the soma as part of the $I_\mathrm{e}$ input
current and through calcium channels; $c$ is a measure of what
fraction of $I_{\mathrm{e}}$ is composed of calcium and $\gamma$ is a
conversion factor which converts the current to a calcium
concentration flux. As well as quantifying the charge of each ion,
this factor needs to account for the distribution of calcium in the
soma; unlike current which depends on membrane area, concentration
depends on volume. However, in the soma the calcium is sequestered in
a thin layer near the membrane. Hence,
\begin{equation}
\gamma=\frac{1}{zF\delta r} 
\end{equation}
where $z=2$ is the electrical charge of the
calcium ion, $\delta r$ is the width of the somatic
submembrane shell and $F$ is Faraday's constant. In the absence of
calcium inflow the calcium concentration returns with rate constant
$\rho=0.02\mathrm{ms}^{-1}$ to a baseline value $[\ca^{2+}]_0
=30\,\mathrm{nM}\cm^{-3}$ through intracellular buffering
\citep{FierroEtAl1998,AiraksinenEtAl1997}; this value has been chosen
so that the timecourse matched the description in
\citet{EilersEtAl1995} of calcium concentration dynamics in the
subsomatic cell of Purkinje cells.

The calcium activated potassium channel is an SK, small conductance,
channel, \citep{LancasterEtAl1991}. The channel dynamics are taken from
\citet{GilliesWillshaw2006} and are described by
\begin{equation}
\label{eq:I_SK}
I_{\sk} = {\bar{g}_{\sk}}w(E_\k-V)
\end{equation}
Channel kinetics are
\begin{align}
\label{eq:w_kinetics}
\frac{dw}{dt} &= \frac{w_\infty- w}{\tau_w}\cr
w_{\infty}   &= \frac{0.81}{1 + \exp{(-(\log{\{[\ca^{2+}]/(1\,\mathrm{nM})\}}+0.3)/0.46)}}\cr
\tau_w &= 40 \mse
\end{align}

\subsection{Implementation and model fitting}

\begin{table*}[!t]
\centering
\textbf{Parameter values}
\begin{center}
  \begin{tabular}{|l l l l l|}
\hline
parameter & both & three-current & five-current &reference \\ \hline
$C$&1 $\mathrm{\mu F}\,\mathrm{cm}^{-2}$&&& \citep{RothHausser2001}\\ \hline
$\bar{g}_\leak$&$2\msi$&&& \citep{RappEtAl1994}\\ \hline
$\bar{g}_\na$&&$105\msi$&$140\msi$&  $\star$\\ \hline
$\bar{g}_\k$&&$15\msi$&$25\msi$& $\star$  \\ \hline
$\bar{g}_\ca$&&& $0.5\msi$& \citep{MiyashoEtAl2001} \\ \hline
$\bar{g}_\sk$&&&$120\msi$& \citep{RubinCleland2006}\\ \hline
$E_\leak$&$-88\mv$&&& \citep{MasoliEtAl2015}\\ \hline
$E_\k$&$-88\mv$&&& \citep{MasoliEtAl2015}\\ \hline
$E_\na$&$45\mv$&&& \citep{DeSchutterBower1994a}\\ \hline
$E_\ca$&&&$135\mv$& \citep{DeSchutterBower1994a}\\ \hline
$[\ca^{2+}]$&&&$30\, \mathrm{nM}\cm^{-3}$& \citep{KanoEtAl1995}\\ \hline
$\delta r$&&&$0.15\,\mu\mathrm{m}$& \\ \hline
$c$&&&$0.02$& \\ \hline
$I_0$&&$63\,\mu\mathrm{A}\cm^{-2}$&$98\,\mu\mathrm{A}\cm^{-2}$& $\star$\\ \hline
$I_{\mathrm{cf}}$&&$8-215\,\mu\mathrm{A}\cm^{-2}$&$8-215\,\mu\mathrm{A}\cm^{-2}$& $\ddagger$\citep{StuartHausser1994}\\ \hline
$\tau_+$&$0.3\mse$&&&  $\ddagger$\citep{StuartHausser1994}\\ \hline
$\tau_-$&$4\mse$&&& $\ddagger$\citep{StuartHausser1994}\\ \hline
\end{tabular}
\end{center}
\caption{Parameter values and their associated references. The
  parameters marks with a star ($\star$) have been handtuned.}
\label{table1}
\end{table*}

Parameter values are given in Table~\ref{table1}. Most parameter
values used in this modelling study were taken from experimental
studies. However, some parameters that are not easily measured
experimentally and here values are used that give a typical complex
spike waveform. As will be discussed, the complex spike waveform is
highly variable with considerable cell to cell variation along with
considerable sensitivity to experimental conditions. Our models are
also capable of producing complex-spike-like activity across a broad
range of parameter values with different parameter sets giving
different complex spike waveforms.

Simulations were run in Python on a CPU. Models were simulated as
ordinary differential equations and integration was performed using
the \texttt{integrate.ode} package in \texttt{scipy} with the
\texttt{BDF} option suitable for stiff problems, this implements a
backward differentiation formula with a Jacobian estimated by finite
differences \citep{ByrneHindmarsh1975}. The sum of the state variable
in the Markov scheme describing the resurgent sodium current
(Table~\ref{fig:MarkovRNa} is one, this should be preserved by the
dynamics and in the numerical scheme this sum is normalized every
0.025 ms. One second of Purkinje cell activity can be simulated in 1
minute 20 seconds.

Optimization was principally performed using a mixture of error
minimization and hand-tuning techniques. We hand-tuned by running
simulations thousands of times with different combinations of
physiologically plausible parameter values to create large grids of
simulated complex spike images and then selecting the best by
eye. Current injections necessary for simulating complex spikes were
comparable to those necessary to reproduce the same complex spike
\textit{in vitro}. In the model, injections of climbing-fibre-like
somatic currents varied from 8 $\mu$A$/$cm$^2$ through to 215
$\mu$A$/$cm$^2$ Fig.~\ref{injection_amplitudes}. Assuming a surface
area of 500 $\mu$m$^2$ this would correspond to current injections
between 0.4 nA and 10.75 nA.

\section{Results}

The three-current and five-current model were tested. After fitting
those parameters that are not known from experiment, the three-current
model simulates complex spikes whose structure exhibits those features
which are broadly typical in Purkinje cells; the five-current model in
addition, simulated the extended refractory period which follows
complex spikes. Table~\ref{table1} gives a list of the model
parameters, giving the source for parameters that have been fixed to
an experimental value and noting which parameters were adjusted to fit
the target complex spike. Fig.~\ref{fig:spike_properties} describes
the properties of simple spikes in the two models and
Fig.~\ref{fig:fi_curve} gives the fI-curves; the rapidity with which
firing rate increases is suprprising, but this sensitivity to current
input is a property of Purkinje cells \cite{DeSchutterBower1994a}.

%this figure is DONE - DO NOT CHANGE IT AGAIN
\begin{figure}[!ht]
  \include{spikes}
  \caption{\textbf{Simple spike properties in the three- and
      five-current models}. To measure the width of a spike, $\delta
    t_1$, a spike is defined as lasting from when the derivative
    $dV/dt$ exceeds 12 Vs$^{-1}$ until when its voltage returns to the
    value it had at that initial point. The post-spike depolarization,
    $\delta t_2$ is defined as the period from the voltage minimum
    to the point the derivative $dV/dt=0$.\label{fig:spike_properties}}
  \begin{center}
    \begin{tabular}{|l l hline|}
      \l
      PROPERTY & THREE-CURRENT (\TEXTBF{A}) & Five-CURRENT (\textbf{B})\\ \hline
      $\delta t_1$ (ms)& 1.85&1.445\\
      max (mV)&16.0&13.37\\
      min (mV)&-58.0 &-58.3\\
      $\delta t_2$ (ms)&4.17&4.45\\
      \hline
    \end{tabular}
    \end{center}
\end{figure}

%we need to finalize this!
\begin{figure}[!ht]
  \include{fi_curves}
  \caption{\textbf{Firing rate and input current for simple spiking in
      the three- and five-current models}. The firing rate for simple
    spikes is plotted as a function of input current; Assuming a
    surface area of 500 $\mu$m$^2$ a range of 5 $\mu$A$/$cm$^2$ would
    correspond to a current injection range of 2.5
    nA.\label{fig:fi_curves}}

\end{figure}


%done
\begin{figure}[!ht]
\includegraphics[width=\linewidth]{fig_cs_i.jpg}
\caption{\textbf{Simulated complex spike responses to increasing
            amplitudes of injected current}. This show the response of the
  three-current model simulation in response to increasing injections
  of climbing-fibre-like somatic current from 10 $\mu$A$/$cm$^2$
  (\textbf{A}) through to 150 $\mu$A$/$cm$^2$ (\textbf{F}). The
  structure of the complex spikes, and the manner of their response to
  increasing amplitudes of injected current are very similar to those
  observed in \cite{DavieEtAl2008}\label{fig_cs_i}
\end{figure}

%doesn't need to be changed.
%\begin{figure}[!ht]
%\includegraphics[width=\linewidth]{Figure2.png}
%\caption{\textbf{Comparison of the input current and complex spike.}
%  This shows 10 ms of the \textbf{(above)} input to the three-current
%  model and \textbf{(below)} complex spike response; the complex spike
%  is the same one shown in Fig.~\ref{injection_amplitudes}Biv. The
%  input departs from $I_0$ at $t=1\mse$.}
%    \label{fig:S1_fig}
%\end{figure}

The three-current model includes a leak channel, a sodium channel with
both transient and resurgent sodium gates, and a fast potassium
channel. The main features of the complex spike shape are found in
this three-current model, Fig.~\ref{fig_cs_i}. With
increasing injections of climbing-fibre-induced somatic current, the
number of spikelets in the simulated complex spike increased from one
to three. Each additional spikelet had successively greater amplitudes
than the spikelet before it. For complex spikes with only two
spikelets the latency from the first to the second spikelet shortens
with increasing current. As the current is increased the number of
spikelets increases to three. Further increases cause the amplitude of
the spikelets to decrease, before the spikelets are lost altogether
and replaced by a depolarisation plateau. The model was robust to
injections of greater parallel fibre current and the subsequent
increases in the rate of simple spike firing.




%doesn't need to be changed.
\begin{figure}[!ht]
  \include{fig_currents_3}
  \caption{\textbf{Currents involved in complex spike formation in the
      three-current model.} This is a currentscape, an approach to
    visualizing neural dynamics introduced in
    \cite{AlonsoMarder2019}. At the top, for reference, is the voltage
    $V$; in the subsequence panels the currents are split between
    inwards and outwards currents; the second panel graphs the inward
    current and the last panel the outward. The third and fourth
    panels show the fraction of, respectively, the inward and outward
    current made up of the the three currents in the model, along with
    the direct current input; the current input $I_{\e}$ is yellow,
    the sodium current, $I_{\na}$ is red, the potassium, $I_{\k}$ is
    green and the leak, $I_{\leak}$, is pink.}
\label{currents_3}
\end{figure}

\begin{figure}[!ht]
  \begin{center}
    \includegraphics{figure_no_current.jpg}
  \end{center}
  \caption{\textbf{The consequence of removing a current.} Here the
    activity in the three-current model is simulated for 105 ms with
    either the potassium current (\textbf{B}, no $I_\k$) or the sodium current
    (\textbf{C}, no I_\na) removed; the normal unadjusted model is shown in \textbf{A} for comparison.}
\label{fig:no_current}
\end{figure}
  
The contributions of each of the individual currents are outlined in
Fig.~\ref{currents_3}.  The interplay between the resurgent sodium and
fast potassium currents is critical in generating the spikelets in the
complex spike. In Fig.~\ref{fig:no_current} we see the spikelet
formation is absent following the removal of the K\textsubscript{v}3.3
current, in line with experimental investigation
\citep{ZaghaEtAl2010}, but there is still a depolarisation plateau
following the injection of climbing fibre current. In the absence of
the sodium current, spikelets are abolished, as are simple spikes but
the size of the climbing fibre current is sufficient to cause a small
spike. The combination of active sodium and potassium currents is
therefore necessary for modelling complex spikes.

\begin{figure}[!ht]
  \include{fr_grna}
\caption{\textbf{Simple spike firing rate and the sodium current.}} 
\label{fig:ss_v_grna}
\end{figure}




%doesn't need to be changed
\begin{figure}[!ht]
  \includegraphics[width=\linewidth]{Figure4.png}
%\includegraphics[width=\linewidth]{JNeuroFigures/figure_4_tau_decay_three_channel_model.jpg}
\caption{\textbf {Response of simulated complex spikes to increasing
    durations of injected current.} The time constant describing the
  decay of the climbing-fibre-like current injection affected the
  shape of the complex spike waveform. Increasing $\tau_-$ from 4 ms
  \textbf{(A)}, 7 ms \textbf{(B)}, 11 ms \textbf{(C)} and 18 ms
  \textbf{(D)} increases the number, but decreases the amplitude, of
  secondary spikelets within the complex spike. Arrows indicate the times
  of the simulated climbing-fibre current injections. The shape of
  these simulated complex spikes are similar to those recorded in
  Purkinje cells \textit{in vitro}, see Figure 6B in
  \protect\citet{MonsivaisEtAl2005}.
\label{fig:injection_durations}}
\end{figure}


It is possible to increase the number of spikelets generated in the
complex spike waveform to more than three by increasing the decay time
constant $\tau_-$ in the injected current $I_{\mathrm{e}}$,
Fig.~\ref{fig:injection_durations}. This is in line with experimental
studies, which have shown that an increase in the number of bursts in
the pre-synaptic olivary action potential generates an increase in
dendritic calcium spikes, which is in turn linearly related to the
number of spikelets in, and duration of, somatic complex spikes
\citep{MathyEtAl2009}. This is presumably due to an increase in the
duration of the climbing-fibre-induced somatic depolarisation.  The
injected current, modelling the climbing-fibre-like input to the soma
\textsl{in vitro} in \citet{DavieEtAl2008}, has a
difference-of-exponentials form with a rise time $\tau_+=0.3\mse$ and
decay time $\tau_-=4\mse$. When the decay time $\tau_-$ is increased
from 4 ms to 18 ms the number of spikelets increases. Spikelet
amplitudes are also affected. In comparison to complex spikes
simulated with decay time $\tau_- = 4\mse$, when the rise time
$\tau_+$ is larger, spikelets in the middle of simulated complex
spikes were reduced in amplitude but the amplitude of those towards
the end of the complex spike are increased.  This is strikingly
similar to the Purkinje cell responses described experimentally
\textsl{in vitro} in \citet{MonsivaisEtAl2005}.


%figure done, fix caption
\begin{figure}[!ht]
\include{cs}
\caption{\textbf{Longer time-base Purkinje cell simulations showing
    complex spike and simple spike activity.} Two second simulation of
  the three-current model \textbf{(A)} and the five-current model
    \textbf{(B)}. Arrows indicate the times of climbing-fibre-like
    current injections.
}
  \begin{center}
    \begin{tabular}{|l l l|}
      \hline
      Property & Three-current (\textbf{A}) & Five-current (\textbf{B})\\ \hline
      $\delta t_1$ (ms)& 13.425&15.43\\
      $\delta t_2$ (ms)&28.92&48.65\\
      \hline
    \end{tabular}
    \end{center}
\label{fig:long_time_base}
\end{figure}

In addition to generating complex spikes, the three-current model also
produces simple spikes, Fig.~\ref{fig:long_time_base}A. A distinctive
feature of Purkinje cell activity is the pause in the ongoing simple
spike activity following a complex spike event
\citep{BellGrimm1969,GranitPhillips1956,Thach1967}, which typically
lasts for $50\mse$. In the three-current model there is only a very
brief cessation in the ongoing simple spike train following the
complex spike event, a pause that was no greater than the $\approx
15\mse$ time between two simple spikes,
Fig.~\ref{fig:long_time_base}A. Thus, the three-current model does not
simulate the interaction between complex spikes and simple spikes. To
address this, two further channels were added: a voltage-gated calcium
channel and a calcium-gated potassium channel.



\begin{figure}[!ht]
  \includegraphics[width=\linewidth]{Figure6.png}
%\includegraphics[width=\linewidth]{JNeuroFigures/figure_4_tau_decay_five_channel_model.jpg}
\caption{\textbf{Response of the five-current model to input is
    similar to the response of the three-current model.} Simulated
  complex spike waveforms in the five-current model with added calcium
  and SK channels behave similarly to increasing time constants
  describing the decay of the injected climbing fibre input as the
  three-current model. Complex spike waveform simulations when
  increasing $\tau_-$ from 4 ms \textbf{(A)}, 7 ms \textbf{(B)}, 11 ms
  \textbf{(C)} and 18 ms \textbf{(D)}. Arrows indicate the times of
  the simlulated climbing-fibre-like current injections.}
\label{S2_Fig}
\end{figure}


\begin{figure*}
  \begin{center}
    \include{fig_currents_3}
  \end{center}
  \end{figure*}



The baseline simple spike rate in the five-current model is $\sim
40\hz$, Fig.~\ref{fig:long_time_base}B. This is in line with the rate
of spontaneous Purkinje cell simple spike activity recorded \textit{in
  vivo} in anaesthetized rat, see for example
\citet{BurroughsEtAl2016}.  The ongoing simple spike activity was
interrupted by simulated complex spikes generated in response to
injections of climbing-fibre-like current. Following individual
complex spikes there was a transient cessation in the simple spike
train that resembles Purkinje cell behaviour observed \textit{in
  vitro} and \textit{in vivo}. This pause lasted for $\sim 40\mse$
before returning to baseline levels of simple spike activity. This
pause was greater than expected if complex spikes and simple spikes
are independent (simple spike interespike interval divided by two, see
\citet{XiaoEtAl2014}), unlike in the three-current model. Simulated
complex spikes in the five-current model, in response to increasing
time constants describing the decay of the injected climbing fibre
input, behave similarly to those simulated in the three-current model,
Fig.~\ref{S2_Fig}.

%figure done, fix caption
\begin{figure}[!ht]
  \includegraphics[width=\linewidth]{figure_gsk.jpg}
%\includegraphics[width=\linewidth]{JNeuroFigures/figure_6_five_channel.jpg}
\caption{\textbf{The model is robust to changes in parameter values.}
 Changing the parameter $\bar{g}_\sk=105\msi$ \textbf{(A)} influences simple
  spike rate and pause duration. Decreasing $\bar{g}_\sk$ from
  $105\msi$ to 80$\msi$ leads to an increase in background simple spike
  rate and a reduction in the duration of the post-complex spike pause
  in simple spike activity \textbf{(B)}, whereas increasing
  $\bar{g}_\sk$ from $105\msi$ to 130$\msi$ decreases simple spike rate
  and increases pause duration \textbf{(C)}. Arrows indicate the time
  of climbing-fibre-like current injection. The model was robust to
  small changes in other parameter values.}
\label{S3_Fig}
\end{figure}


%figure done, fix caption
\begin{figure}[!ht]
  \includegraphics[width=\linewidth]{figure_delta_r.jpg}
%\includegraphics[width=\linewidth]{JNeuroFigures/figure_6_five_channel.jpg}
\caption{\textbf{The model is robust to changes in parameter values.}
 Changing the parameter $\bar{g}_\sk=105\msi$ \textbf{(A)} influences simple
  spike rate and pause duration. Decreasing $\bar{g}_\sk$ from
  $105\msi$ to 80$\msi$ leads to an increase in background simple spike
  rate and a reduction in the duration of the post-complex spike pause
  in simple spike activity \textbf{(B)}, whereas increasing
  $\bar{g}_\sk$ from $105\msi$ to 130$\msi$ decreases simple spike rate
  and increases pause duration \textbf{(C)}. Arrows indicate the time
  of climbing-fibre-like current injection. The model was robust to
  small changes in other parameter values.}
\label{S3_Fig}
\end{figure}



Changes in the activity of the SK channel was found to influence
Purkinje cell simple spike rate. Increases in the maximum conductance
through either the calcium-activated potassium channel or the calcium
channel prolonged the duration of the post-complex spike pause in
simple spike activity and reduced baseline simple spike rates, whereas
decreases in maximal conductance reduced the duration of the pause and
increased simple spike firing frequency, see
Fig.~\ref{S3_Fig}. Increasing $\bar{g}_\sk$ in the model caused a
slight increase in simple spike rate above baseline levels after the
pause. This is reminiscent of simple spike modulation observed in
Purkinje cells \textsl{in vivo} \citep{BurroughsEtAl2016}.


\section{Discussion}


The present study tested, through computational modelling, the
possibility that key features of Purkinje cell complex spike waveform
can be generated by a limited number of channel-dynamics. Our
three-current model exhibits the main features of the complex spike: a
high-amplitude initial spike that is followed by a succession of
smaller amplitude spikelets with the first spikelet having a smaller
amplitude than those that follow. In the five-current model, which
extends the three-current model by including a P/Q type calcium
channel and a calcium-activated potassium channel, some of the
interactions between complex spike activity and background simples
spike behaviour are also observed in simulations.

In these models, the dynamics of the resurgent sodium channel has a
crucial role in producing the complex spike waveform, which is in line
with experiments
\citep{RamanBean1997,NolanEtAl2003,KhaliqRaman2006}. After the initial
spike of the complex spike, channels become sequestered in the
open-but-blocked state so that the following spikelets are stunted
relative to the initial spike and blocked channels returning to the
open state help sustain the depolarization for subsequent spikelet
generation.


%figure done, fix caption
\begin{figure}[!ht]
%  \includegraphics[width=\linewidth]{figure_gl_3.jpg}
%\includegraphics[width=\linewidth]{JNeuroFigures/figure_6_five_channel.jpg}
\caption{\textbf{Other models} A half second of simulation.
}

  \begin{center}
    \begin{tabular}{|l l l l l|}
      \hline
      Property &  \textbf{A} & \textbf{B} & \textbf{C} & \textbf{D}\\ \hline
      $g_{\mathrm{l}}$ (mS)& 4& 2&1&0.2\\
        $g_\na$ (mS)&202&105&55&25\\
        $g_\k$ (mS)&30&15&8&15\\
      $I_0$ ($\mu$Acm$^{-2}$)  &124         &63&31&5.5\\
      $I_{\mathrm{cf}}$ ($\mu$Acm$^{-2}$) &110&90&55&40\\
      \hline
    \end{tabular}
    \end{center}


\label{Fig:gl_3}
\end{figure}

\begin{figure*}
  \begin{center}
    \include{fig_currents_5}
  \end{center}
  \end{figure*}

\begin{figure*}
  \begin{center}
    \include{current_2}
  \end{center}
  \end{figure*}


In fact, somatic complex spikes are often thought to be generated by
an interplay between the resurgent sodium current
\citep{RamanBean1997,RamanBean2001,KhaliqEtAl2003,KhaliqRaman2006} and
the current through the fast potassium channel K\textsubscript{v}3.3
\citep{ZaghaEtAl2008,HurlockEtAl2008,VeysEtAl2013}; this is the
point-of-view developed in the two models presented in this paper and
these models are intended as a demonstration that this is a plausible
description of complex spike generation.

In Purkinje cells, resurgent sodium current is conducted through
Na\textsubscript{v}1.6 channels \citep{RamanBean1997} and is estimated
to contribute 40\% of total sodium current generated during a simple
spike \citep{RamanBean2001}, although others suggest this figure is
only 15\% \citep{LevinEtAl2006}. Resurgent sodium channels are found in
numerous neuronal types throughout the brain and spinal cord
\citep{OsorioEtAl2010}, and are unusual in that once they open they
either inactivate or enter into a reversible open-but-blocked state
that is non-conducting, see Table~\ref{fig:MarkovRNa}. Phosphorylation
of the cytosolic $\beta_4$ subunit terminal may be responsible for
this form of open channel block \citep{GriecoEtAl2002}. Upon
repolarisation, channels in the open-but-blocked configuration return
through the open configuration to either a closed or inactive state.

In Purkinje cells, the K\textsubscript{v}3.3 potassium channel is
responsible for rapid repolarisation \citep{VeysEtAl2013} because of
its fast channel kinetics
\citep{RudyEtAl1999,RudyMcBain2001}. These fast potassium dynamics
enable spikelet frequency to reach their observed $\sim 600\hz$
frequency \citep{WarnaarEtAl2015,BurroughsEtAl2016}. Somatic, but not
dendritic, K\textsubscript{v}3.3 channels are critical to repetitive
spikelet generation and define the shape of the Purkinje cell complex
spike \citep{HurlockEtAl2008,ZaghaEtAl2008,VeysEtAl2013}.

The multi-compartmental model developed in
\citet{DeSchutterBower1994a,DeSchutterBower1994b,DeSchutterBower1994c}
also shows a complex spike waveform under some conditions. These
complex spikes do not have the architecture of relative spikelet
amplitudes and inter-spikelet intervals subsequently observed
\textit{in vitro} and the spikelets are generated by a different
mechanism: the interplay of a delayed rectifier potassium current and
the fast, transient sodium current. The multi-compartmental model has
a delayed rectifier potassium current with unusually large opening and
closing rates, exceeding experimental values by a factor of five
\citep{YamadaEtAl1989}; this plays a similar role to the
K\textsubscript{v}3.3 fast delayed rectifier potassium gate,
\citep{VeysEtAl2013,ZaghaEtAl2008} used in the models described here:
K\textsubscript{v}3.3 is necessary for the rapid repolarisation of the
membrane following each spike or spikelet, as noted experimentally in
\citet{ZaghaEtAl2008,VeysEtAl2013}. \citet{ZangEtAl2018} have recently
developed a full scale compartmental model, this model does simulate
the complex spike, but only in the contex of a very large model which
does not clarify which aspect of the model are required for complex
spike generation.

In the models presented here an unusually large leak conductance of
$2\msi$ was necessary to accurately represent the dynamics of complex
spikes recorded \textit{in vitro}, namely the high spikelet firing
frequency, the latencies between individual spikelets and the
progressive increase in spikelet amplitude throughout the complex
spike; thus, the model suggests that the passive resistance of the
Purkinje cell somatic membrane is low. Evidence in support of this has
been found experimentally, as a disparity between somatic and
dendritic membrane resistance is present in Purkinje cells
\citep{RappEtAl1994}. This disparity is also a feature of the model in
\citet{DeSchutterBower1994a,DeSchutterBower1994b,DeSchutterBower1994c}
where somatic membrane resistance was $440\,\Omega\,\mathrm{cm}^2$,
which is equivalent to a conductance of $\approx 2.3\msi$, compared to
$11\,\mathrm{k}\Omega\,\mathrm{cm}^2$ in the dendrites. Membrane
resistance determines the membrane time constant which, in turn,
determines the time scale over which the cell responds to input. With
low resistivity, the Purkinje cell soma will have a smaller membrane
time constant than the dendrites, facilitating the generation of very
fast spikelets \citep{WarnaarEtAl2015}.

The shape of the complex spike waveforms, including complex spike
duration, spikelet amplitudes and spikelet timing, generated in the
two models is robust to changes in parameter values. Both fixed and
free parameters can be changed without significantly altering these
complex spike dynamics. The exception to this is the applied
background current: as well as reducing simple spike activity,
reducing the background current increases the amplitude of spikelets.

Calcium-activated potassium channels are included in the five-current
model because they contribute to interactions between complex spikes
and simple spike activity and regulate Purkinje cell output
\citep{TankEtAl1988,McKayEtAl2007}. SK channels play an important role
in limiting the firing rate of Purkinje cell simple spike activity
\citep{WomackEtAl2003,EgorovaEtAl2014}, which is often
correlated with complex spike activity. In the absence of complex
spiking, simple spike firing frequencies increase to exceptionally
high levels \citep{CerminaraRawson2004}. SK channels are also
responsible for afterhyperpolarisations that follow bursts of action
potentials \citep{HosyEtAl2011}, which may underlie the climbing
fibre-induced pause and downregulation of simple spikes
\citep{Xian-HuaEtAl2017}. The model of the calcium-activated potassium
current used here and taken from \citet{GilliesWillshaw2006} is one of
a number of models for the SK channel, for example, the alternative
model used in \citet{GriffithEtAl2016} based on
\citet{ChayKeizer1983,XiaEtAl1998} has a steeper and quicker modulation
of the channel by calcium concentration. Furthermore, the model from
\citet{GilliesWillshaw2006} simplifies the original dynamics described
in \citet{HirschbergEtAl1998} and a future elaboration of the Purkinje
cell model presented here might consider how the richer temporal
dynamics in \citet{HirschbergEtAl1998}, with different calcium
concentration decay rates, might affect the behaviour of the model.

The dynamics of intracellular calcium concentration is based on
\citet{EilersEtAl1995} where it was demonstrated that intracellular
calcium signalling within the Purkinje cell soma is not temporally nor
spatially uniform. Within a narrow submembrane shell of 2 to 3 $\mu$
m, calcium transients are large and fast when compared to the interior
of the soma. The calcium concentration within this narrow submembrane
region was modelled in the present study. Intracellular calcium
dynamics, in particular the time course of calcium concentration
decay, was found to modulate simulated Purkinje cell simple spike
activity. However, it should be noted that the five-current model
includes parameters, such as the submembrane shell thickness and decay
in calcium concentration, that are not well-specified experimentally
and in any case likely depend on somatic morphology, something that is
variable across Purkinje cells.

Although the three-current and five-current models differ in how the
complex spike affects simple spiking, there is almost no difference in
the complex spike waveform in the two models, Fig.~\ref{S2_Fig}. On
the other hand, the shape of the pre-synaptic climbing fibre input
seems to be critical in shaping complex spike waveforms and so changes
in this input provides a possible mechanism for their variation.

Purkinje cells \textsl{in vitro} sometimes show a bimodal pattern of
simple spike activity, cycling between an \textsl{up} and a
\textsl{down} state. The up state is characterised by high simple
spike rates whereas in the down state simple spiking is
quiescent. Several models of Purkinje cell activity have attempted to
describe this bimodality
\citep{Forrest2014,ForrestEtAl2012,LlinasSugimori1980b,LoewensteinEtAl2005,McKayEtAl2007,WilliamsEtAl2002}. Combined theoretical and experimental work has shown that Purkinje cells exhibit a phenomenon known as inverse stochastic resonance. This means they can efficiently transitions between different functional regimes depending on the variability of their synaptic input \citep{buchin2016inverse}. The
models presented in the current study do not exhibit bimodal behaviour and the
bimodality is not generally representative of the firing patterns
observed \textsl{in vivo}
\citep{CerminaraRawson2004,McKayEtAl2007,SchonewilleEtAl2006}.

The simplified Purkinje cell models presented here do not include some
of the channels known to be expressed in the Purkinje cell
membrane. These include the HCN1 channel, which may be responsible for
bimodal patterns of activity \citep{LoewensteinEtAl2005}, the
calcium-activated intermediate conductance (IK) and big conducance
(BK) potassium channels, which contribute to the regulation of
Purkinje cell excitability and rhythmicity \citep{CheronEtAl2009}, the
persistent sodium channel, which is involved in nonlinear synaptic
gain, plateau potentials and subthreshold oscillations
\citep{KayEtAl1998}, the K\textsubscript{v}1.1 channel, which prevents
hyperexcitability \citep{ZhangEtAl1999}, the T-type calcium channels,
which play a role in rhythmicity and bursting behaviour, for review
see \citet{CainSnutch2010}, and the inwardly rectifying potassium
channels, which are activated by GABA\textsubscript{B} receptors
\citep{TabataEtAl2005}. These currents are likely to play a role in
modulating Purkinje cell activity.


The models presented in this study are tuned to match complex spikes
recorded \textsl{in vitro} in \citet{DavieEtAl2008}. This example is
chosen because it typifies features of the complex spike
waveform observed in numerous \textsl{in vitro} studies
\citep{ZaghaEtAl2008,zhang2017ethanol,MonsivaisEtAl2005,khaliq2005axonal} and in an \textsl{in vivo} study, \citet{WarnaarEtAl2015}:
\textsl{in vivo} studies that give wave form data are less common. These feature, which are broadly
stereotypical are
\begin{enumerate}
\item the first spike is similar in shape to the simple spike,
\item the first spikelet is smaller in amplitude than subsequent spikelets,
\item spikelets get further apart with increasing current injections or spikelet number.
\end{enumerate}
The comples spikes recorded in \citet{DavieEtAl2008} were also used as
a target beause the complex spike waveforms were recorded in response
to increasing injections of climbing fibre like currents. This
describes the complex spike waveform response to different somatic
inputs and provides a useful range of responses to use as a target for
model fitting. The typical features of complex spikes and the response
to varying input are exemplified by the fitted model. The five-current
model also captures the extended refractory period that follows a
complex spike; since this feature is easily seen in extra-cellular
recordings, it is supported by a larger range of \textsl{in vivo}
data, see for example
\citet{GranitPhillips1956,LathamPaul1970,BloedelRoberts1971,ArmstrongRawson1979,BausweinEtAl1983,SatoEtAl1992,BurroughsEtAl2016}.

However, complex spikes do exhibit large amounts of variability
\citep{BurroughsEtAl2016,WarnaarEtAl2015}. Interestingly both the
three- and five-current models presented here can be
used to describe these variations: for example, the difference in
complex spikes seen in \citet{MonsivaisEtAl2005} matches the variation
in waveform seen in Fig.~\ref{S2_Fig}.

Obviously, restricting the model to a single somatic compartment is a
substantial simplification. Along with removing any affect of the
complex somatic morphology, it fails to model the coupling between the
soma and dendrite. This is significant because the extensive dendritic
arborisations that characterise Purkinje cells means that there are
space clamp limitations associated with recording from Purkinje
cells. Removing the coupling to the dendrite is an approximation and
rules out the possibility, in our models, that current flow from the
soma to the dendrite might have a role in the production of complex
spikes. However, as discussed above, the complex spike has been shown
to be generated only within the proximal axon, the structure of the
dendritic input is lost during transmission to the soma and there is a
large discrepancy between the membrane resistance in the soma with
current from the soma to the dendrite likely to be small. As such,
since one-compartment models are considerably easier to interpret,
this suggests a one-compartment model is useful at this level of
approximation.

Experimentally, a positive correlation has been observed between
simple spike rate and the number of spikelets making up a subsequent
complex spike waveform \textit{in vivo}
\citep{BurroughsEtAl2016}. While the five-current model did simulate
the extended refractory period that follows a complex spike, it was
unable to capture these more complicated interactions between complex
spike waveform changes and simple spike dynamics, suggesting that
these may result from mechanisms located outside of the soma, such as
dendritic computations, synaptic plasticity or network effects. In the
future these models will be useful as a component in a larger model of
local cerebellar circuitry.

Here the model can capture a more physiological response to
experimentally recorded trains of parallel fibre and climbing fibre
activity and be useful in identifying how the network responds to
complex spike waveform and simple spike activity. The models presented
here could be used to address a number of further questions including,
but not limited to, the influence of synaptic plasticity at single
synapses on Purkinje cell activity, the temporal significance of spike
activity patterns, the contribution of individual channels to specific
electrophysiological properties and how these are modulated by
neurotransmission and intracellular pathways. This will enable us to
gain a better insight into the electrodynamics supporting cerebellar
function and to make predictions about network dynamics, including
those that occur during learning or aberrant activity associated with
disease, which could then be tested experimentally.


\begin{acknowledgements}
Special thanks go to Beverley Clark and Jennifer Davie for providing
us with \textit{in vitro} complex spike data to which this model is
tuned.
\end{acknowledgements}

\section*{Conflict of Interest}
The authors declare that they have no conflict of interest.

\section*{Code Availability Statement}
The Python code used to create the figures is available at \texttt{github.com/PurkinjeCellSimpleModel}.


\bibliography{references}



\end{document}
